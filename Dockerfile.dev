FROM node:12

RUN npm install -g mocha chai

WORKDIR /do-dydns
COPY . .
RUN ls

# install the api dependencie
WORKDIR /do-dydns/api
COPY ./api/package.json package.json
COPY ./api/package-lock.json package-lock.json
RUN npm install

# install the frontend dependencies
WORKDIR /do-dydns/frontend
COPY ./frontend/package.json package.json
COPY ./frontend/package-lock.json package-lock.json
RUN npm install

WORKDIR /do-dydns
RUN ls

# expose the ports
EXPOSE 9229
EXPOSE 3000
EXPOSE 3080

# copy the applicatio
COPY ./api/ /do-dydns/api
COPY ./frontend/ /do-dydns/frontend
COPY ./scripts/start-do-dydns-dev.sh .

RUN chmod +x ./start-do-dydns-dev.sh

CMD ./start-do-dydns-dev.sh
